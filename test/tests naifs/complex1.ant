include Numbers.ants

func SearchFood() {

    if (food is left)
    then {
        call turn5;
        
        call PickUpFood;
    }
    else {
        if (food is right)
        then {
            call turn1;
            
            call PickUpFood;
        }
        else {
            do {
                call PickUpFood;
            }
            if (food is ahead)
        }
   } *se tourne vers là où il y a de la nouriture, si il y en a et va en pickup dans ce cas*

    call VerifAhead;
    Libre:

    if (bit(!00) is here)
    then {
        nop;
    }
    else {
        if (bit(!01) is here)
        then {
            nop;
        }
        else {
            if (bit(!02) is here)
            then {
                nop;
            }
            else {   
                if (bit(!03) is here)
                then {
                    nop;
                }
                else {   
                    if (bit(!04) is here)
                    then {
                        nop;
                    }
                    else {   
                        if (bit(!05) is here)
                        then {
                            nop;
                        }
                        else {   
                            mark(!00);
                        }
                    }
                }
            }
        }
    } *marque sa direction si le chemin n est pas déjà marqué*


    if (friendWithFood is ahead)
    then {
        call turn1;
        
        move(1);
        call turn5;
        
        move(1);
        call turn1;
        
    } *contourne un allié si il y en a un sur le passage*
    else {
        if (rock is ahead)
        then {
            call turn3;
            
        }
        else {
            move(1);
        }
    } *fais demi-tour si il y a un rocher, avance sinon*
}

func PickUpFood (){
    if (bit(!00) is here)
    then {
        nop;
    }
    else {
        if (bit(!01) is here)
        then {
            nop;
        }
        else {
            if (
                bit(!02) is here
            )
            then {
                nop;
            }
            else {   
                if (
                    bit(!03) is here
                )
                then {
                    nop;
                }
                else {   
                    if (
                        bit(!04) is here
                    )
                    then {
                        nop;
                    }
                    else {   
                        if (
                            bit(!05) is here
                        )
                        then {
                            nop;
                        }
                        else {   
                            mark(!01);
                        }
                    }
                }
            }
        }
    } *marque sa direction si le chemin n est pas déjà marqué*

    if (friendWithFood is ahead)
    then {
        call turn1;
        
        move(1);
        call turn5;
        
        move(1);
        call turn1;
        
    } *contourne un allié si il y en a un sur le passage*
    else {
        if (rock is ahead)
        then {
            call turn3;
            
        }
        else {
            move(1);
        }
    } *fais demi-tour si il y a un rocher, avance sinon*

    pickup(SerachFood); *si pas de nouriture, refais une recherche*
    call turn3; *sinon, fais demi-tour et rammene la nouriture*
    
    call BackFood; *essaye de prendre de la nouriture*
}

func BackFood () {
    do {
        drop();
        call turn3;
        
        call SerachFood;
    }
    if (home is here)

    if (bit(!00) is here)
    then {
        nop;
    }
    else {
        if (bit(!01) is here)
        then {
            call turn1;
            
        }
        else {
            if (bit(!02) is here)
            then {
                call turn2;
                
            }
            else {
                if (bit(!03) is here)
                then {
                    call turn3;
                    
                }
                else {
                    if (bit(!04) is here)
                    then {
                        call turn4;
                        
                    }
                    else {
                        if (bit(!05) is here)
                        then {
                            call turn5;
                            
                        }
                        else {
                            nop;
                        }
                    }
                }
            }
        }
    } *suivit du chemin de retour*
    *le numéro du bit à tester dépend de l orientation de la fourmi*
    move(1);
}

func VerifAhead() {
    if (bit(!00) is ahead)
    then {
        call VerifRight;
    }
    else {
        if (bit(!01) is ahead)
        then {
            call VerifRight;
        }
        else {
            if (bit(!02) is ahead)
            then {
                call VerifRight;
            }
            else {   
                if (bit(!03) is ahead)
                then {
                    call VerifRight;
                }
                else {   
                    if (bit(!04) is ahead)
                    then {
                        call VerifRight;
                    }
                    else {   
                        if (bit(!05) is ahead)
                        then {
                            call VerifRight;
                        }
                        else {   
                            goto libre;
                        }
                    }
                }
            }
        }
    }
}

func VerifRight() {
    if (bit(!00) is right)
    then {
        call Verifleft;
    }
    else {
        if (bit(!01) is right)
        then {
            call Verifleft;
        }
        else {
            if (bit(!02) is right)
            then {
                call Verifleft;
            }
            else {   
                if (bit(!03) is right)
                then {
                    call Verifleft;
                }
                else {   
                    if (bit(!04) is right)
                    then {
                        call Verifleft;
                    }
                    else {   
                        if (bit(!05) is right)
                        then {
                            call Verifleft;
                        }
                        else {   
                            call turn1;
                            
                            goto libre;
                        }
                    }
                }
            }
        }
    }
}

func VerifLeft() {
    if (bit(!00) is left)
    then {
        call DirAlea;
    }
    else {
        if (bit(!01) is left)
        then {
            call DirAlea;
        }
        else {
            if (bit(!02) is left)
            then {
                call DirAlea;
            }
            else {   
                if (bit(!03) is left)
                then {
                    call DirAlea;
                }
                else {   
                    if (bit(!04) is left)
                    then {
                        call DirAlea;
                    }
                    else {   
                        if (bit(!05) is left)
                        then {
                            call DirAlea;
                        }
                        else {
                            call turn5;
                            
                            goto Libre;
                        }
                    }
                }
            }
        }
    }
}

func DirAlea() {
    do {
        call turn1;
        
        goto Libre;
    }
    if (randint(3) is 0)
    do {
        call turn5;
        
        goto Libre;
    }
    if (randint(2) is 0)
    goto Libre;
}

func turn1 () {
    turn(1);
    varif (compass is 0 )
    then {
        compass = 1;
    }
    else {
        varif (compass is 1)
        then {
            compass = 2;
        }
        else {
            varif (compass is 2)
            then {
                compass = 3;
            }
            else {
                varif (compass is 3)
                then {
                    compass = 4;
                }
                else {
                    varif (compass is 4)
                    then {
                        compass = 5;
                    }
                    else {
                        compass = 0;
                    }
                }   
            }
        }
    }
    return;
}

func turn2 () {
    turn(2);
    varif (compass is 0 )
    then {
        compass = 2;
    }
    else {
        varif (compass is 1)
        then {
            compass = 3;
        }
        else {
            varif (compass is 2)
            then {
                compass = 4;
            }
            else {
                varif (compass is 3)
                then {
                    compass = 5;
                }
                else {
                    varif (compass is 4)
                    then {
                        compass = 0;
                    }
                    else {
                        compass = 1;
                    }
                }   
            }
        }
    }
}

func turn3 () {
    turn(3);
    varif (compass is 0 )
    then {
        compass = 3;
    }
    else {
        varif (compass is 1)
        then {
            compass = 4;
        }
        else {
            varif (compass is 2)
            then {
                compass = 5;
            }
            else {
                varif (compass is 3)
                then {
                    compass = 0;
                }
                else {
                    varif (compass is 4)
                    then {
                        compass = 1;
                    }
                    else {
                        compass = 2;
                    }
                }   
            }
        }
    }
}

func turn4 () {
    turn(4);
    varif (compass is 0 )
    then {
        compass = 4;
    }
    else {
        varif (compass is 1)
        then {
            compass = 5;
        }
        else {
            varif (compass is 2)
            then {
                compass =0;
            }
            else {
                varif (compass is 3)
                then {
                    compass = 1;
                }
                else {
                    varif (compass is 4)
                    then {
                        compass = 2;
                    }
                    else {
                        compass = 3;
                    }
                }   
            }
        }
    }
}

func turn5 () {
    turn(5);
    varif (compass is 0 )
    then {
        compass = 5;
    }
    else {
        varif (compass is 1)
        then {
            compass = 0;
        }
        else {
            varif (compass is 2)
            then {
                compass = 1;
            }
            else {
                varif (compass is 3)
                then {
                    compass = 2;
                }
                else {
                    varif (compass is 4)
                    then {
                        compass = 3;
                    }
                    else {
                        compass = 4;
                    }
                }   
            }
        }
    }
}

